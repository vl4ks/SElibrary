openapi: 3.0.4

info:
  title: SElibrary API
  description: Backend API for Library Management System
  version: 1.0.0

servers:
  - url: http://localhost:8080
    description: Local server

tags:
  - name: Auth
  - name: Catalog
  - name: Customer
  - name: Circulation
  - name: Collections
  - name: Report

paths:

  # =========================
  # AUTH
  # =========================

  /api/auth/login:
    post:
      tags: [Auth]
      summary: User login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [username, password]
              properties:
                username:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Successful login
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /api/auth/logout:
    get:
      tags: [Auth]
      summary: User logout
      responses:
        '200':
          description: Successful logout

  # =========================
  # CATALOG
  # =========================

  /api/catalog/search:
    post:
      tags: [Catalog]
      summary: Search books
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                author:
                  type: string
                subject:
                  type: string
                page:
                  type: integer
      responses:
        '200':
          description: Search result
          content:
            application/json:
              schema:
                type: object
                properties:
                  rows:
                    type: array
                    items:
                      type: object
                      properties:
                        book_id:
                          type: string
                        title:
                          type: string
                        authors:
                          type: array
                          items:
                            type: string
                  total:
                    type: integer

  /api/catalog/books/{bookId}:
    get:
      tags: [Catalog]
      summary: Get book details
      parameters:
        - name: bookId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Book details
          content:
            application/json:
              schema:
                type: object

  /api/catalog/authors/{bookId}:
    get:
      tags: [Catalog]
      summary: Get authors of book
      parameters:
        - name: bookId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: List of authors
          content:
            application/json:
              schema:
                type: object
                properties:
                  authors:
                    type: array
                    items:
                      type: object
                      properties:
                        author_id:
                          type: integer
                        name:
                          type: string

  # =========================
  # CUSTOMER
  # =========================

  /api/customer/search:
    get:
      tags: [Customer]
      summary: Search customers
      parameters:
        - name: customerId
          in: query
          schema:
            type: string
        - name: name
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Customer list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    customerID:
                      type: string
                    name:
                      type: string
                    address:
                      type: string
                    postalCode:
                      type: string
                    city:
                      type: string

  /api/customer:
    post:
      tags: [Customer]
      summary: Add customer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                address:
                  type: string
                postalCode:
                  type: string
                city:
                  type: string
                phone:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: Customer created

  /api/customer/{id}:
    get:
      tags: [Customer]
      summary: Get customer by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Customer data
          content:
            application/json:
              schema:
                type: object

    put:
      tags: [Customer]
      summary: Update customer
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Customer updated

  /api/circulation/customer/{id}:
    get:
      tags: [Circulation]
      summary: Get customer circulation
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Circulation info
          content:
            application/json:
              schema:
                type: object

  /api/circulation/issue:
    post:
      tags: [Circulation]
      summary: Issue book
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [bookId, customerId]
              properties:
                bookId:
                  type: string
                customerId:
                  type: string
      responses:
        '200':
          description: Book issued

  /api/circulation/return:
    post:
      tags: [Circulation]
      summary: Return book
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [bookId, customerId]
              properties:
                bookId:
                  type: string
                customerId:
                  type: string
      responses:
        '200':
          description: Book returned

  /api/circulation/renew:
    post:
      tags: [Circulation]
      summary: Renew book
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [bookId, customerId]
              properties:
                bookId:
                  type: string
                customerId:
                  type: string
      responses:
        '200':
          description: Book renewed

  /api/collections:
    get:
      tags: [Collections]
      summary: Get all collections
      responses:
        '200':
          description: Collection list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    title:
                      type: string
                    books:
                      type: array
                      items:
                        type: object
                        properties:
                          title:
                            type: string
                          image:
                            type: string

    post:
      tags: [Collections]
      summary: Create collection
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title]
              properties:
                title:
                  type: string
                books:
                  type: array
                  items:
                    type: object
                    properties:
                      title:
                        type: string
                      image:
                        type: string
      responses:
        '200':
          description: Collection created

  /api/collections/{id}:
    patch:
      tags: [Collections]
      summary: Update collection
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Collection updated

    delete:
      tags: [Collections]
      summary: Delete collection
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Collection deleted


  /api/report/reminders:
    get:
      tags: [Report]
      summary: Overdue books
      responses:
        '200':
          description: Overdue list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object

  /api/report/search:
    post:
      tags: [Report]
      summary: Search history
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                bookId:
                  type: string
                bookTitle:
                  type: string
      responses:
        '200':
          description: History result

  /api/report/export:
    post:
      tags: [Report]
      summary: Export history to CSV
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: CSV file
          content:
            text/csv:
              schema:
                type: string
                format: binary
